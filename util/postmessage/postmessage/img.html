<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>HTML5 使用postMessage在不同網頁之間傳送文字訊息(傳送頁面)</title>
        <style>
        </style>
    </head>
    <body>
        HTML5 使用postMessage在不同網頁之間傳送圖片(傳送頁面)<br>
        測試範例：<br>
        1.選擇圖片：<input id="pic_file"  type="file" onchange="showPic()"/><br>
           <img id="myimg" src="" width="300"/><br>
        2.<button onclick="sendImg()">傳送圖片到 iframe 頁面</button>
        
        <br><br>
        <iframe id="myiframe" src="./img-new.html" width="500" height="300"></iframe>
        
        <script>
            window.URL = window.URL || window.webkitURL;
        
            /* 傳送圖片給 Iframe */
            function sendImg() {
                var frame_win = document.getElementById("myiframe").contentWindow;
                var img = document.getElementById("pic_file").files[0];
                frame_win.postMessage(img, "http://www.jiweiwei.com");//表示要送給demo2.example.com網域
            }
            
            /* 圖片預覽 */
            function showPic() {
                var img = document.getElementById("pic_file").files[0];   
                if (img) {
                    var img_url = window.URL.createObjectURL(new Blob([img]));
                    document.getElementById('myimg').src = img_url;
                }
            }
        </script>
    </body>
</html>